module FortuneTeller
  module SpendingStrategy

    # The transforms generated by a spending strategy object
    class Transform < FortuneTeller::Base::Transform
      attr_reader :withdrawal
      def initialize(holder:, date:, amount:, take_homes:)
        @amount = amount
        super(holder: holder, date: date)
      end

      def apply_to!(sim:)
        desired_withdrawal = sim.inflate(amount: @amount, date: @date) - sim.guaranteed_take_home(date.year, date.month)
        sim.debit(amount: desired_withdrawal, date: date)
      end

    end
  end
end